CGC Website Repository
===========================

This repository contains the CGC Web application.

Installation
------------

 > cd local/perl/path
 > perl -Mlocal::lib=./
 > eval $(perl -Mlocal::lib=./)
 > cd $approot
 > perl Makefile.PL
 > make installdeps
 > mysql -u user -ppassword -e 'create database cgc_YYYYMMDD'
 > mysql -u -p cgc_YYYYMMDD < schema/cgc.sql
 > mysql -u -p cgc_YYYYMMDD < util/sql/user_database.sql
 (You'll either need to make a symlink for cgc-[DATE] -> cgc in your data directory
  or change the name of the database in your configuration file)

# Get bootstrap
git submodule update --init


Populate the database
-----------------------------------

1. Fetch data from the CGC

 > mkdir data/YYYY-MM-DD
 > cd YYYY-MM-DD
 > mkdir foxpro foxpro_tsv wormbase
 > cd foxpro
 // Minimally get the following files from the CGC
 cgcmail.txt frzloc.txt gophstrnt.txt lablist.txt transrec.txt
 > cp gophstrn.txt ../foxpro_tsv/strain.ego

2. Convert FoxPro data dumps
 > cd $APP/util/import
 > ./foxpro_parser.pl $APP/data/YYYY.MM.DD/foxpro/cgcmail.txt > $APP/data/YYYY.MM.DD/foxpro_tsv/cgcmail.tsv
 > ./foxpro_parser.pl $APP/data/YYYY.MM.DD/foxpro/frzloc.txt > $APP/data/YYYY.MM.DD/foxpro_tsv/frzloc.tsv
 > ./foxpro_parser.pl $APP/data/YYYY.MM.DD/foxpro/lablist.txt > $APP/data/YYYY.MM.DD/foxpro_tsv/lablist.tsv
 > ./foxpro_parser.pl $APP/data/YYYY.MM.DD/foxpro/transrec.txt > $APP/data/YYYY.MM.DD/foxpro_tsv/transrec.tsv

3. Import CGC data

 > export CGC_DB=cgc
 > export IMPORT_DIR=$APP/data/YYYY.MM.DD/foxpro_tsv
 > ./util/import/import.pl --verbose 2 --dir $IMPORT_DIR









Running the application
-----------------------

To run the app using the built-in Catalyst server:

> ./script/cgc_server.pl -p 8000

For more control you can use your own configuration:

> CGC_CONFIG_LOCAL_SUFFIX=tharris ./script/cgc_server.pl -p 8000

This will use configuration in $approot/cgc_tharris.conf
to override the default cgc.conf file.


Running the application via Starman
-----------------------------------

 > script/cgc-init.sh

Todd Harris (todd@hiline.co)