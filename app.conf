######################################################
#
#  App Default Configuration
#
#  This file contains defaults for the application.
#  It should not be edited.  Should you wish to over-ride any
#  variables, provide them in a local configuration file
#  according to the following rules.
#
#  Configuration file precedence (highest to lowest)
#
#  1. Via environment variable provided on the command line
#     or in the script/app-init.sh script. For example, the following
#     command will load $approot/wormbase_staging.conf with the highest
#     precedence.
#    
#     CATALYST_CONFIG_LOCAL_SUFFIX=staging ./script/wormbase_server.pl -p 8000             
#
#  2. Alternatively, provide a local configuration file
#     $approot/app_local.conf
#
#  3. This file:
#     $approot/app.conf
#
######################################################


######################################################
#
#   General
#
######################################################
site_name   = CGC
site_byline = Caenorhabditis Genetics Center

# Version information
version      = 0.01
perl_version = 5.010000

# Are we a (development|mirror|local|production) site?
installation_type   = production

# This is the site-wide (dismissable) system message.
# The id is used to make sure a new message won't be hidden
<system_message>
    message = "Welcome to WormBase 2 (beta) - fill out our <a target=\"_blank\" href=\"https://spreadsheets.google.com/a/wormbase.org/spreadsheet/viewform?formkey=dDhYMkwySVhPNHRqeFlkbkFBZkZrQlE6MQ\">User Survey</a>!"
    id = 001
</system_message>

# enable_ssl = 1; 
#       secure_uri_for will return the uri with the scheme https
# enable_ssl = 0; 
#       secure_uri_for will return the results of uri_for
enable_ssl = 0

# Are we using a front end proxy in front of our server?
# At WormBase, typically we are (except when running the Catalyst server itself)
using_frontend_proxy = 1

# BASE URL: Not required for default installations
# base = http://beta.wormbase.org/


######################################################
#
#   Debugging 
#
######################################################

# debug: enable system-wide debugging; expects boolean
debug = 0
# debug_view: style of the view debugging. Off by default
#    unless "debug" is set above and debug_view set to 
#    one of
#     comment - send debugging statements as HTML comments
#     browser - send debugging statements in formatted divs
#     log     - send to the error log file
debug_view =


######################################################
#
#   User Interface
#
######################################################

#  Widget timing information.
#  Enable display of timing, back end server, 
#  and cache information. You must also be an
#  administrator. Uncommenting disables BOTH 
#  the collection and display of this information.
timer = 0



########################################################
#
#  FILE PATHS
#
########################################################

tmp_img_base     = /tmp


########################################################
#
#  Cache
#
########################################################

########################################################
#
#  EMAILS
#
########################################################

# Issue tracking and reporting - specified in app_local.conf
# issue_email = 

# Registering a new account - specified in app_local.conf
# register_email =

########################################################
#
#  API & REST CONFIGURATION
#  Should probably be Controller::REST
#
########################################################
<api>
      <content_type>
         application/json = json 
         text/xml         = xml
         text/x-yaml      = yml
         text/html        = html
      </content_type>
</api>


########################################################
# Authentication&Authorization: Configuration in Web.pm
########################################################
#<authentication>
#  default_realm = members 
#  <realms>
#    <members>
#        <credential> 
#   </credential> 
#   <store>
#     class = DBIx::Class
#     user_model = Schema::User
#     role_relation = roles
#     role_field = role
#     #ignore_fields_in_find = remote_name
#     #use_userdata_from_session = 1,
#   </store>
#    </members>
#    <openid>
#      <credential>
#   class = OpenID
#   ua_class = LWP::UserAgent
#   <extensions>
#           http://openid.net/extensions/sreg/1.1
#           required =  email
#      optional =  fullname nickname timezone
#        </extensions>
#      </credential> 
#    </openid>
#  </realms>                       
#</authentication>

#<Model::Schema>
#  schema_class = CGC::Schema
#  <connect_info>  
#         dsn =  dbi:mysql:cgc:hostname=localhost
#         user = root
#         password = 3l3g@nz
#   </connect_info>
#</Model::Schema>

########################################################
#
#  Database Locations and Authorization
#
#  By default, we use remote data sources for
#  convenience but expect this to be overriden
#  by the wormbase_local.conf.
#
########################################################
<Model::ExternalModel>
  class = App::Web::Model::ExternalModel
  <args>
    conf_dir    = __path_to(conf)__/
    
    # Temporary directory in filesystem space    
    # tmp_base    = __path_to(root)__/tmp/
    # tmp_base      = /tmp/wormbase/
    # In production, this is an nfs mount
    tmp_base      = /usr/local/app/tmp/

    # Probably unnecessary
    <mysql>
      delay = 600
      reconnect = 3
      host  = localhost  
      user  = app_user
      pass  = 
      <data_sources>
          clustal  = 1
      </data_sources>
    </mysql>
  </args>
</Model::ExternalModel>
  
########################################################
# 
#  
#   Plugins
#
#
############################################################

<stacktrace>
    enable      1
</stacktrace>

<Plugin::ErrorCatcher>
    enable      1
</Plugin::ErrorCatcher>

<Plugin::ErrorCatcher::Email>
    to      todd@hiline.co   
    from    todd@hiline.co 
    use_tags 1
  #  subject Error Report from: %h; %F, line %l
</Plugin::ErrorCatcher::Email>

# Session database
#<Plugin::Session>
#	expires           = 3600
#	dbi_dbh           = Schema 
#	dbi_table         = sessions
#	dbi_id_field      = session_id
#	dbi_data_field    = session_data
#	dbi_expires_field = expires
#</Plugin::Session>

# Which hash elements of the data structure to return in JSON renders?
<View::JSON>
    expose_stash = data
</View::JSON>



########################################################
# 
#  
#   NAVBAR configuration
#
#
############################################################

# These items will appear on the global navigation bar.
# Strains will be a dropdown.
<nav_bar>
     option about
     option strains
     option nomenclature
     option contact
</nav_bar>

# Search box dropdown
#    A quick list of available searches.
#    Remove entries from here to 
#    prevent them from appearing as an option in the navbar
#    global search drop down menu.
#    Order is important.

<search_dropdown>
    <option>
        title = All
        id    = all
    </option>
    <option>
        title = Strains
        id    = strain
    </option>
    <option>
        title = Alleles
        id    = allele
    </option>
    <option>
         title = Gene Class
         id    = gene_class
    </option>
    <option>
        title = Laboratory
        id    = laboratory
    </option>
    <option>
        title = Person
        id    = person
    </option>   
     <option>
         title = Transgene
         id    = transgene
     </option>
    <option>
        title = Variation
        id    = variation
    </option>   
</search_dropdown>





########################################################
# 
#  
# Website sections: strains, tools, resources, me.
#
#  This section configures the available pages, widgets
#  and fields for each section of the application.
#
#  REMEMBER: If you change the name of anything here,
#  you will also need to change the name of the 
#  corresponding method in the Model class and the name 
#  of the template
#
############################################################


<sections>

  ######################################
  #
  # Strain pages.
  #
  ###################################### 
  <strains>
    title = Strains

    # These are pulled DIRECTLY from the CGC site.
    <how_to_order>
	title    = How to order strains
	template = docs/how_to_order.tt2 
    </how_to_order>

    # The "Strains > CGC Strain List" link takes users to a page pseudotabs:
    # search (default), view cart, checkout
    # Not sure yet if this is required.
    <search_strains>
	title    = Search Strains
	template = strains/full_list.tt2
    </search_strains>

    # Should just be a link to download the full list.
    # Could have a controller intervene.
    <full_strain_list>
	title    = Browse Full List
	template = strains/full_list.tt2
    </full_strain_list>

  </strains>


  ######################################
  #
  # Resource pages.
  #
  ###################################### 

  <resources>
  title = Resources
  </resources>



  ######################################
  #
  # Tools.
  #
  ###################################### 

  <tools>
	title = Tools
    <wormmart>
        title  = WormMart
        display = report
        display_in_dropdown yes
    </wormmart>
  </tools>


  ######################################
  #
  # Me
  # 
  ###################################### 

  <me>
      <widgets>
        <reports>
          name reports
          title My Favourites
        </reports>
#         <sequences>
#           name sequences
#           title My Sequences
#         </sequences>
#         <clipboard>
#           name clipboard
#           title My Clipboard
#         </clipboard>
        <user_history>
          name user_history
          title My History
        </user_history>
        <profile>
          name profile
          title My Profile
          login = 1
        </profile>
    <issue>
          name issue
          title My Issues
          login = 1
        </issue>
        <my_library>
          name my_library
          title My Library
        </my_library>
      </widgets>
  </me>
</sections>

