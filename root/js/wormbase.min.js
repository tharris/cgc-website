+function(a,b,c){var d=a.location,e=jQuery.noConflict(),f=function(){function n(){var a=e("#header").data("page"),b=e("#all-search-results");e(".user-history").size()>0&&function d(){v(e(".user-history"),"/rest/history?count=3"),setTimeout(d,6e5);return}(),e.post("/rest/history",{ref:a.ref,name:a.name,id:a.id,"class":a["class"],type:a.type,is_obj:a.is_obj}),A(a["class"]),e("#top-system-message").size()>0&&t("show");if(b.size()>0){var c=b.data("search");D(c.type,c.species,c.query),X.search}bc.init(),_.init(a),ba.init(a),e(".workbench-status-"+a.wbid).size()>0&&e(".workbench-status-"+a.wbid).load("/rest/workbench/star?wbid="+a.wbid+"&name="+a.name+"&class="+a["class"]+"&type="+a.type+"&id="+a.id+"&url="+a.ref+"&save_to="+a.save+"&is_obj="+a.is_obj),Y(a.ref),o(),p(),q(),r()}function o(){y(),e("#nav-bar").find("ul li").hover(function(){e("div.columns>ul").hide(),f&&(e(this).siblings("li").children("ul.dropdown").hide(),e(this).siblings("li").children("a").removeClass("hover"),e(this).children("ul.dropdown").find("a").removeClass("hover"),e(this).children("ul.dropdown").find("ul.dropdown").hide(),clearTimeout(f),f=c),e(this).children("ul.dropdown").show(),e(this).children("a").addClass("hover")},function(){var a=e(this);f&&(clearTimeout(f),f=c),f=setTimeout(function(){a.children("ul.dropdown").hide(),a.children("a").removeClass("hover")},300)}),v(e(".status-bar"),"/rest/auth",c,function(){e("#bench-status").load("/rest/workbench");var b=e("#login");b.size()>0?b.click(function(){e(this).siblings().toggle(),e(this).toggleClass("open ui-corner-top")}):e("#logout").click(function(){a.open("/logout","pop","status=no,resizable=yes,height=2px,width=2px").blur()})})}function p(){var a=e("#person-search"),b=e("#column-dropdown");w(),e("#print").click(function(){var a=d.hash.replace("#",""),b=e(this);e.ajax({type:"POST",url:"/rest/print",data:{layout:a},beforeSend:function(){u(b)},success:function(a){b.html(""),d.href=a},error:function(a,b,c){alert(a+" "+b+" "+c)}})}),e(".section-button").click(function(){var a=e(this).attr("wname");e("#nav-"+a).trigger("open"),M(a)}),e(".sortable").size()>0&&e(".sortable").sortable({handle:".widget-header, #widget-footer",items:"li.widget",placeholder:"placeholder",connectWith:".sortable",opacity:.6,forcePlaceholderSize:!0,update:function(a,b){U()}}),b.find("a, div.columns div.ui-icon, div.columns>ul>li>a").click(function(){e("div.columns>ul").toggle()}),b.children("ul").children("li").hover(function(){e(this).children("ul").show()},function(){var a=e(this).children("ul");setTimeout(function(){a.hide()},500)}),e("#nav-min").click(function(){var a=e(".navigation").add("#navigation"),b=e("#page-title"),c=a.width(),d="open sidebar",f="-1em";c==0?(c="12em",d="close sidebar",f=175):c=0,a.animate({width:c}).show(),b.animate({marginLeft:f}).show(),a.children("#title").children("div").toggle(),e(this).attr("title",d),e(this).children("#nav-min-icon").toggleClass("ui-icon-triangle-1-w").toggleClass("ui-icon-triangle-1-e")}),e("#hide-empty-fields").click(function(){e(".disabled").toggle(),e(this).toggleClass("ui-state-highlight")}),a.size()>0&&v(a,a.attr("href"),c,function(){a.delegate(".results-person .result li a","click",function(){e(".ui-state-highlight").removeClass("ui-state-highlight");var a=e(this).attr("href").split("/").pop();return e.ajax({type:"GET",url:"/auth/info/"+a,dataType:"json",success:function(a){var b=e("#link-account");if(b.size()==0){e("input#name").attr("value",a.fullname).attr("disabled","disabled");var c=new String(a.email);if(a.email&&a.status_ok){var d=new RegExp(e("input#email").attr("value"),"gi");(c.match(d)||!e("input#email").attr("value"))&&e("#email").attr("disabled","disabled").parent().hide(),e("input#wbemail").attr("value",c).parent().show()}else e("input#wbemail").attr("value","").parent().hide(),e("#email").removeAttr("disabled").parent().show();e(".register-notice").html("<span id='fade'>"+a.message+"</span>").show(),e("input#wbid").attr("value",a.wbid)}else{e("input#wbid").attr("value",a.wbid),e("input#email").attr("value",a.email),b.removeAttr("disabled"),e("input#confirm").attr("value","");var f=["[% emails.join('","') %]"];if(a.email&&a.status_ok){var g=""+a.email;for(var h=0;h<f.length;h++){var d=new RegExp(f[h],"gi");if(g.match(d)){e(".register-notice").css("visibility","hidden"),e("input#confirm").attr("value",1);return}}}else b.attr("disabled",1);e(".register-notice").html("<span id='fade'>"+a.message+"</span>").css("visibility","visible")}},error:function(a,b,c){alert(a+" "+b+" "+c)}}),e(this).parent().parent().addClass("ui-state-highlight"),!1})})}function q(){var c=e("#widget-holder"),f=e("#widgets"),g=e(".list-layouts"),h;if(c.size()==0)return;a.onhashchange=P,d.hash.length>0?P():(h=c.data("layout"))&&L(h),g.size()>0&&v(g,"/rest/layout_list/"+g.attr("type")),f.find(".module-load, .module-close").click(function(){var a=e(this).attr("wname"),b=e("#nav-"+a),d="div#"+a+"-content";if(!b.hasClass("ui-selected")){if(e(d).text().length<4){var f=".left";if(V(c)>=90)c.children(".right").children(".visible").height()&&(f=".right");else{var g=parseFloat(c.children(".left").css("height")),h=parseFloat(c.children(".right").css("height"));h<g&&(f=".right")}F(a,b,d,f)}else e(d).parents("li").addClass("visible"),b.addClass("ui-selected");M(a)}else b.removeClass("ui-selected"),e(d).parents("li").removeClass("visible");return U(),!1}),X.sidebarInit(),c.children("#widget-header").disableSelection(),c.find(".module-max").click(function(){var c=e(this).parents(".widget-container"),d=c.clone(),f=a.open("","test","height="+c.height()+",width="+c.width());f.document.write(b.head.innerHTML),f.document.write(d.html())}),f.find(".module-load, .module-close").bind("open",function(){var a=e(this).attr("wname"),b=e("#nav-"+a),c="div#"+a+"-content";return F(a,b,c,".left"),!1}),c.find(".module-min").click(function(){var a=e("#"+e(this).attr("wname")+"-content"),b=e(this);a.next().slideToggle("fast"),a.slideToggle("fast"),b.parent().toggleClass("minimized"),b.attr("show")!=1?(b.attr("show",1).attr("title","maximize"),b.removeClass("ui-icon-circle-triangle-s").removeClass("ui-icon-triangle-1-s"),b.addClass("ui-icon-circle-triangle-e")):(b.attr("show",0).attr("title","minimize"),b.removeClass("ui-icon-circle-triangle-e"),b.addClass("ui-icon-circle-triangle-s"))}),c.find(".reload").click(function(){G(e(this).attr("wname"))}),e(".feed").click(function(){var a=e(this).attr("rel"),b=e(this).parent().next("#widget-feed");b.filter(":hidden").empty().load(a),b.slideToggle("fast")})}function r(){function b(a,b){var c=a.height();c<40?(c="100%",a.prev(".ellipsis").add(a.prev().prev().prev(".author-list")).add(a.prev().prev().prev().prev().children(".paper-title")).removeClass("ellipsis")):(c="2.4em",a.prev(":not(.gene-link)").add(a.prev().prev().prev(".author-list")).add(a.prev().prev().prev().prev().children(".paper-title")).addClass("ellipsis")),a.css("max-height","none"),a.animate({height:c}),b.children(".ui-icon").toggleClass("ui-icon-triangle-1-s"),b.children(".ui-icon").toggleClass("ui-icon-triangle-1-n"),b.toggleClass("open")}var a=e("#content");e("body").delegate(".toggle","click",function(){return e(this).toggleClass("active").next().slideToggle("fast",function(){e.colorbox&&e.colorbox.resize()}),!1}),a.delegate(".tooltip","mouseover",function(){var a=e(this);bj(function(){a.cluetip({activation:"click",sticky:!0,cluetipClass:"jtip",dropShadow:!1,closePosition:"title",arrows:!0,hoverIntent:!1})})}),a.delegate(".text-min","click",function(){b(e(this),e(this).next())}),a.delegate(".more","click",function(){b(e(this).prev(),e(this))}),a.delegate(".text-min","mouseover mouseout",function(){e(this).next().toggleClass("opaque")}),a.delegate(".tip-simple","mouseover",function(){if(!e(this).children("div.tip-elem").show().children('span:not(".ui-icon")').text(e(this).attr("tip")).size()){var a=e('<div class="tip-elem tip ui-corner-all" style="display:block"><span>'+e(this).attr("tip")+'</span><span class="tip-elem ui-icon ui-icon-triangle-1-s"></span></div>');a.appendTo(e(this)).show()}}),a.delegate(".tip-simple","mouseout",function(){e(this).children("div.tip-elem").hide()}),a.delegate(".slink","mouseover",function(){var a=e(this);bl(function(){a.colorbox({data:a.attr("href"),width:"750px",height:"550px",title:function(){return a.prev().text()+" sequence"}})})}),a.delegate(".bench-update","click",function(){var a=e(this).attr("wbid"),b=e(this).attr("objclass"),c=e(this).attr("name"),d=e(this).attr("url"),f=e(this).attr("is_obj"),g=e(this).attr("href")+"?name="+escape(c)+"&class="+b+"&url="+d+"&is_obj="+f;return e("#bench-status").load(g,function(){v(e(".workbench-status-"+a),"/rest/workbench/star?wbid="+a+"&name="+escape(c)+"&class="+b+"&url="+d+"&is_obj="+f,1),b!="paper"?v(e("div#reports-content"),"/rest/widget/me/reports",1):v(e("div#my_library-content"),"/rest/widget/me/my_library",1)}),!1})}function s(a){g&&(clearTimeout(g),g=c);var b=e("#notifications");b.show().children("#notification-text").text(a),g=setTimeout(function(){b.fadeOut(400)},3e3)}function t(a,b){var d=e(".system-message");a=="show"?(d.show().css("display","block").animate({height:"20px"},"slow"),e("#notifications").css("top","20px"),X.set_system_message(20)):(d.animate({height:"0px"},"slow",c,function(){e(this).hide()}),e.post("/rest/system_message/"+b),X.set_system_message(0),e("#notifications").css("top","0"))}function u(a){a.html('<div class="loading"><img src="/img/ajax-loader.gif" alt="Loading..." /></div>')}function v(a,b,c,d){e.ajax({url:b,beforeSend:function(){c||u(a)},success:function(b){a.html(b)},error:function(b,c,d){var f=e(b.responseText);a.html('<p class="error"><strong>Oops!</strong> Try that again in a few moments.</p>'),a.append(f.find(".error-message-technical").html())},complete:function(a,b){d&&d()}})}function w(){var a,b=!1;e("#operator-box").click(function(){var a=e(this);b||(v(e("#operator-box"),"/rest/livechat",0,function(){e("#operator-box").hasClass("minimize")&&e("#operator-box").children().hide()}),b=!0),a.hasClass("minimize")?(a.removeClass("minimize"),a.animate({width:"9em"}),a.children().show()):(a.addClass("minimize"),a.animate({width:"1.5em"}),a.children().hide())}),e("#operator").click(function(){if(e(this).attr("rel"))e.post("/rest/livechat?open=1",function(){d.href="/tools/operator"});else{var c=e("#operator-box");v(c,"/rest/livechat",0,function(){c.hasClass("minimize")&&c.children().hide()}),b=!0,c.hasClass("minimize")&&(c.removeClass("minimize"),c.animate({width:"9em"}),c.children().show()),a=setTimeout(function(){c.addClass("minimize"),c.animate({width:"1.5em"}),c.children().hide()},4e3)}})}function x(a){var b=e(a);b.attr("value")!=""&&b.siblings().fadeOut(),b.focus(function(){e(this).siblings().fadeOut()}),b.blur(function(){e(this).attr("value")==""&&e(this).siblings().fadeIn()})}function y(){var a=e("#Search"),b="search...",c=e("#searchForm"),f;a.focus(function(a){e(this).addClass("active")}),a.blur(function(a){e(this).removeClass("active")}),a.focus(function(){e(this).attr("value")==b&&e(this).attr("value","")}),a.blur(function(){e(this).attr("value")==""&&e(this).attr("value",b)}),a.autocomplete({source:function(a,b){f=e.getJSON("/search/autocomplete/"+h,a,function(a,c,d){d===f&&b(a)})},minLength:2,select:function(a,b){d.href=b.item.url}})}function z(a){a?h="all":a="Search";var b=e("#"+a).attr("value");if(b=="search..."||!b)b="*";b=encodeURIComponent(b),b=b.replace("%26","&"),b=b.replace("%2F","/"),d.href="/search/"+h+"/"+b}function A(a,b){if(!a||a=="home"||a=="me"||a=="bench")a="gene";h=a;if(a=="all")a="for anything";else{var c="for a";a.match(/^[aeiou]/)&&(c=c+"n"),a=c+" "+a.replace(/[_]/," ")}e("#current-search").text(a)}function B(a,b,c,d,f){function n(a){if(m.length==0)return;bi(function(){for(var b=0;b<m.length;b++)m[b]&&a.highlight(m[b])})}var g=decodeURI(a),h=1,i=0,j=e((d?"."+d+"-widget ":"")+"#count"),l=e((d?"."+d+"-widget ":"")+".load-results"),m=g?g.replace(/[,\.\*]/," ").split(" "):[];this.setTotal=function(a){i=a,j.html(i)},X.search,n(e("div#results"+(d?"."+d+"-widget":""))),l.click(function(){var a=e(this).attr("href")+(h+1)+"?"+(c?"species="+c:"")+(d?"&widget="+d:"")+(f?"&nostar="+f:"");div=e("<div></div>"),res=e((d?"."+d+"-widget":"")+" #load-results"),e(this).removeClass("load-results"),h++,u(div),res.html("loading..."),div.load(a,function(a,b,c){var d=i-h*10;d>0?(d>10&&(d=10),res.addClass("load-results"),res.html("load "+d+" more results")):res.remove(),n(div);if(b=="error"){var f="Sorry but there was an error: ";e(this).html(f+c.status+" "+c.statusText)}}),div.appendTo(e(this).parent().children("ul")),k++})}function C(b){var c=e("#all-search-results");return c.empty(),v(c,b),k=0,e(a).scrollTop(0),e("#navigation").find(".ui-selected").removeClass("ui-selected"),X.resetSidebar(),!1}function D(a,b,c){var d="/search/"+a+"/"+c+"/?inline=1",f=e("#all-search-results");f.empty(),b&&(d=d+"&species="+b),v(f,d),e("#search-count-summary").find(".count").each(function(){e(this).load(e(this).attr("href"),function(){e(this).text()=="0"?e(this).parent().remove():e(this).parent().show()})})}function E(a,b,c){try{var d=_gat._createTracker("UA-16257183-1");d._trackEvent(b,c)}catch(e){}}function F(a,b,c,d){var c=e(c),f=b.attr("href");return c.closest("li").appendTo(e("#widget-holder").children(d)),H(c.parent(".widget-container")),c.text().length<4&&v(c,f),b.addClass("ui-selected"),c.parents("li").addClass("visible"),!1}function G(a){var b=e("#nav-"+a),c=b.attr("href");v(e("div#"+a+"-content"),c)}function H(a){a.find("div.module-min").addClass("ui-icon-large ui-icon-triangle-1-s").attr("title","minimize"),a.find("div.module-close").addClass("ui-icon ui-icon-large ui-icon-close").hide(),a.find("div.module-max").addClass("ui-icon ui-icon-extlink").hide(),a.find("#widget-footer").hide(),a.find(".widget-header").children("h3").children("span.hide").hide(),a.find(".widget-header").hover(function(){e(this).children("h3").children("span").show()},function(){e(this).children("h3").children("span.hide").hide()}),a.hover(function(){e(this).find(".widget-header").children(".ui-icon").show(),e(this).find(".widget-header").children("h3").children(".module-min").attr("show")!=1&&e(this).find("#widget-footer").show()},function(){e(this).find(".widget-header").children(".ui-icon").hide(),e(this).find("#widget-footer").hide()}),a.find("div.module-min").hover(function(){e(this).attr("show")!=1?e(this).addClass("ui-icon-circle-triangle-s"):e(this).addClass("ui-icon-circle-triangle-e")},function(){e(this).removeClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-e"),e(this).attr("show")!=1?e(this).addClass("ui-icon-triangle-1-s"):e(this).addClass("ui-icon-triangle-1-e")}),a.find("div.module-close").hover(function(){e(this).addClass("ui-icon-circle-close")},function(){e(this).removeClass("ui-icon-circle-close").addClass("ui-icon-close")})}function I(a,b,c){var d=e("#widget-holder");a>99?d.children(".sortable").css("min-height","0"):d.children(".sortable").css("min-height","5em"),d.children(".left").css("width",a+"%"),b==0&&(b=100),d.children(".right").css("width",b+"%"),c||U()}function J(a){var b=e("#widget-holder").attr("wclass");e.get("/rest/layout/"+b+"/"+a+"?delete=1"),e("div.columns ul div li#layout-"+a).remove()}function K(a){var b=e("#widget-holder").attr("wclass");e.get("/rest/layout/"+b+"/"+a,function(a){var b=a.childNodes[0].childNodes,c=b.length;for(i=0;i<c;i++){var e=b.item(i);e.nodeName=="data"&&(d.hash=e.attributes.getNamedItem("lstring").nodeValue)}},"xml")}function L(a){a=a||e("#widget-holder").data("layout"),a.hash?d.hash=a.hash:(W(a.leftlist,a.rightlist||[],a.leftwidth||100),j++,U())}function M(a){b.getElementById(a).scrollIntoView(!0)}function N(a){return U(a,function(){e(".list-layouts").load("/rest/layout_list/"+e(".list-layouts").attr("type"),function(a,b,c){if(b=="error"){var d="Sorry but there was an error: ";e(".list-layouts").html(d+c.status+" "+c.statusText)}})}),!1}function O(a,b,c){var f=e.map(a,function(a){return R(a)}),g=e.map(b,function(a){return R(a)}),h=f.join("")+"-"+g.join("")+"-"+c/10;return d.hash&&decodeURI(d.hash).match(/^[#](.*)$/)[1]!=h&&j++,d.hash=h,h}function P(){if(j==0){var a=decodeURI(d.hash).match(/^[#](.*)$/)[1].split("-");if(!a)return;var b=a[0],c=a[1],f=a[2]*10;b&&(b=e.map(b.split(""),function(a){return T(a)})),c&&(c=e.map(c.split(""),function(a){return T(a)})),W(b,c,f)}else j--}function R(a){return Q.list.indexOf(a).toString(36)}function S(){var b="";for(i=0;i<Q.list.length-3;i++)b=b+i.toString(36);return a.location.hash=b+"--10",!1}function T(a){return Q.list[parseInt(a,36)]}function U(a,b){var c=e("#widget-holder"),d=c.attr("wclass"),f=c.children(".left").children(".visible").map(function(){return this.id}).get(),g=c.children(".right").children(".visible").map(function(){return this.id}).get(),h=V(c),i=O(f,g,h),j="default";typeof a=="string"&&(j=escape(a)),e.post("/rest/layout/"+d+"/"+j,{lstring:i},function(){b&&b()})}function V(a){var b=parseFloat(a.css("width")),c=parseFloat(a.children(".left").css("width"))/b*100;return Math.round(c)}function W(a,b,c){e("#navigation").find(".ui-selected").removeClass("ui-selected"),e("#widget-holder").children().children("li").removeClass("visible"),I(c,100-c,1);for(var f=0;f<a.length;f++){var g=e.trim(a[f]);if(g.length>0){var h=e("#nav-"+g),i="div#"+g+"-content";F(g,h,i,".left")}}for(var f=0;f<b.length;f++){var g=e.trim(b[f]);if(g.length>0){var h=e("#nav-"+g),i="div#"+g+"-content";F(g,h,i,".right")}}d.hash.length>0&&U()}function Y(a){var b=e(".comment-count");if(b.size()==0)return;b.load("/rest/feed/comment?count=1;url="+a);var c=e("<span></span>");c.load("/rest/feed/issue?count=1;url="+a,function(){c.html()!="0"&&e(".issue-count").html("!").css({color:"red"})})}function Z(a,b,c,d,e){if(a.val()==""&&(!e||e.val()==""))return a.focus().addClass("ui-state-error"),!1;if(a.val()&&$(a.val(),"Not a valid email address!")==!1)return a.focus().addClass("ui-state-error"),!1;if(!c)return b&&b.val()==""?(b.focus().addClass("ui-state-error"),!1):!0;if(c.val()=="")return c.focus().addClass("ui-state-error"),!1;if(d&&c.val()!=d.val())return alert("The passwords do not match. Please enter again"),c.focus().addClass("ui-state-error"),!1}function $(a,b){var c=a.indexOf("@"),d=a.lastIndexOf(".");return c<1||d-c<2?(alert(b),!1):!0}function bg(a,d,e,f){var g=b.documentElement,h=b.createElement("script"),i=!1;m=!0,h.src=d;if(e){var j=b.createElement("link");j.href=e,j.rel="stylesheet",b.getElementsByTagName("head")[0].appendChild(j)}return h.onload=h.onreadystatechange=function(){!i&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(i=!0,m=!1,l[a]=!0,f(),h.onload=h.onreadystatechange=null,g&&h.parentNode&&g.removeChild(h))},g.insertBefore(h,g.firstChild),c}function bh(a){bm("dataTables","/js/jquery/plugins/dataTables/media/js/jquery.dataTables.min.js","/js/jquery/plugins/dataTables/media/css/demo_table.min.css",a);return}function bi(a){bm("highlight","/js/jquery/plugins/jquery.highlight-1.1.js",c,a);return}function bj(a){bm("cluetip","/js/jquery/plugins/cluetip-1.0.6/jquery.cluetip.min.js","/js/jquery/plugins/cluetip-1.0.6/jquery.cluetip.css",a);return}function bk(a){bm("markitup","/js/jquery/plugins/markitup/jquery.markitup.js","/js/jquery/plugins/markitup/skins/markitup/style.css",function(){bm("markitup-wiki","/js/jquery/plugins/markitup/sets/wiki/set.js","/js/jquery/plugins/markitup/sets/wiki/style.css",a)});return}function bl(a){bm("colorbox","/js/jquery/plugins/colorbox/colorbox/jquery.colorbox-min.js","/js/jquery/plugins/colorbox/colorbox/colorbox.css",a);return}function bm(a,b,c,d){if(!l[a])bg(a,b,c,d);else{if(m){setTimeout(bm(a,b,c,d),1);return}d()}return}var f,g,h="all",j=0,k=0,l=new Array,m=!1;e("#notifications").click(function(){g&&(clearTimeout(g),g=c),e(this).hide()});var Q=this.wl||function(){var a=this,b=e("#navigation"),c=b.find(".module-load").map(function(){return this.getAttribute("wname")}).get();return this.wl={list:c},this.wl}(),X=function(){function g(){f=0,e("#navigation").stop().css("position","relative").css("top",0)}function h(){var a=e("#navigation"),g=a.offset().top,h=e("#widget-holder"),i=0,j;a.find(".title").click(function(){e(this).children(".ui-icon").toggleClass("ui-icon-triangle-1-s").toggleClass("ui-icon-triangle-1-e")}),c.scroll(function(){if(a.offset()){var k=a.outerHeight()<c.height()-d,l=c.scrollTop(),m=e(b).height()-(a.outerHeight()+e("#footer").outerHeight()+d+20);k?f==0?l>g&&l<m?(a.stop().css("position","fixed").css("top",d),f++):l>m&&a.stop().css("top",d-(l-m)):l<g?(a.stop().css("position","relative").css("top",0),f--):l>m&&(a.stop().css("top",d-(l-m)),f--):i==0&&(j=a.find(".ui-icon-triangle-1-s"))&&(a.outerHeight()<h.height()?(i++,j.last().parent().click().delay(250).queue(function(){i--})):a.stop().css("position","relative").css("top",0))}})}function j(a){d=a}var c=e(a),d=0,f=0,i=i||function(){return c.scroll(function(){var a=e("#results.lazyload-widget");if(a.offset()&&k<3){var b=a.height()+a.offset().top,d=b-(c.height()+c.scrollTop());d<400&&a.children(".load-results").trigger("click")}}),!0}();return{sidebarInit:h,search:i,set_system_message:j,resetSidebar:g}}();Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1});var _={init:function(a){_.url=a.ref},submit:function(a){var b=a.closest("#comment-new"),c=b.find(".comment-content").val();if(c==""||c=="write a comment...")return alert("Please provide your name & comment"),!1;e.ajax({type:"POST",url:"/rest/feed/comment",data:{content:c,url:_.url},success:function(a){s("Comment Submitted!"),b.find("#comment-box").prepend(a),b.find(".comment-content").val("write a comment..."),Y(url)},error:function(a,b,c){alert(a+" "+b+" "+c)}});var d=e('<div class="comment-box"><a href="/me">'+name+"</a> "+c+'<br /><span id="fade">just now</span></div>'),f=e("#comments");return f.prepend(d),!1},cmDelete:function(a){var b=a.attr("id"),c=a.attr("rel");e.ajax({type:"POST",url:c,data:{method:"delete",id:b},success:function(a){Y(c)},error:function(a,b,c){alert(a+" "+b+" "+c)}}),a.parent().remove()}},ba={init:function(a){ba.url=a.ref},submit:function(a){var b=a.attr("rel"),c=a.attr("url"),d=a.attr("page"),f=a.closest("#issues-new"),g=f.find("#email"),h=f.find("#display-name"),i=f.find("#isprivate:checked").size();return g.attr("id")&&h.attr("id")&&Z(g,h)==!1?!1:(e.ajax({type:"POST",url:b,data:{title:f.find("#title").val(),content:f.find("#content").val(),email:g.val(),username:h.val(),url:ba.url,isprivate:i},success:function(a){a==0?alert("The email address has already been registered! Please sign in."):(s("Problem Submitted! We will be in touch soon."),f.closest("#widget-feed").hide(),Y(c),G("issue"))},error:function(a,b,c){alert(a+" "+b+" "+c)}}),!1)},isDelete:function(b){var c=b.attr("rel"),d=new Array;e(".issue-deletebox").filter(":checked").each(function(){d.push(e(this).attr("name"))});var f=confirm("Do you really want to delete these issues: #"+d.join(" #"));f&&e.ajax({type:"POST",url:c,data:{method:"delete",issues:d.join("_")},success:function(b){a.location.reload(1),Y(c)},error:function(a,b,c){alert(a+" "+b+" "+c)}})},update:function(b,c){var d=b.attr("rel"),f=b.closest("#threads-new");return e.ajax({type:"POST",url:d,data:{content:e("textarea").val(),issue:c,state:e("#issue_status option:selected").val(),severity:e("#issue_severity option:selected").val(),assigned_to:e("#issue_assigned_to option:selected").val()},success:function(b){a.location.reload()},error:function(a,b,c){}}),!1}},bb={update:function(a,b){a||(a="0");var c=e("li#static-widget-"+a),d=c.find("input#widget_title").val(),f=c.find("input#widget-order").val(),g=c.find("textarea#widget_content").val();e.ajax({type:"POST",url:"/rest/widget/static/"+a,dataType:"json",data:{widget_title:d,path:b,widget_content:g,widget_order:f},success:function(b){bb.reload(a,0,b.widget_id)},error:function(a,b,c){alert(a+" "+b+" "+c)}})},edit:function(a,b){var c=a.split("-").pop(),d=e("#"+a+"-content"),f=d.parent(),g=f.find("a#edit-button");g.hasClass("ui-state-highlight")?bb.reload(c):(g.addClass("ui-state-highlight"),d.load("/rest/widget/static/"+c+"?edit=1"))},reload:function(a,b,c){var d=e("#static-widget-"+a+"-content"),f=d.parent(),g=f.find("h3 span.widget-title input"),h="/rest/widget/static/"+(c||a);g.size()>0&&g.parent().html(g.val()),f.find("a.button").removeClass("ui-state-highlight"),e("#nav-static-widget-"+a).text(g.val()),b&&(h=h+"?rev="+b),d.load(h)},delete_widget:function(a){confirm("are you sure you want to delete this widget?")&&e.ajax({type:"POST",url:"/rest/widget/static/"+a+"?delete=1",success:function(b){e("#nav-static-widget-"+a).click().hide()},error:function(a,b,c){alert(a+" "+b+" "+c)}})},history:function(a){var b=e("#"+a),c=b.find("div#"+a+"-history");if(c.size()>0)c.toggle(),b.find("a#history-button").toggleClass("ui-state-highlight");else{var d=a.split("-").pop(),c=e('<div id="'+a+'-history"></div>');c.load("rest/widget/static/"+d+"?history=1"),b.find("div.content").append(c),b.find("a#history-button").addClass("ui-state-highlight")}}},bc={init:function(){this.bc=e("#breadcrumbs");if(!this.bc)return;this.children=this.bc.children(),this.bCount=this.children.size();if(this.bCount<3)return;this.exp=!1,this.bc.empty();var a=this.children.slice(0,this.bCount-2),b=this.children.slice(this.bCount-2);this.hiddenContainer=e('<span id="breadcrumbs-hide"></span>'),this.hiddenContainer.append(a).children().after(" &raquo; "),this.bc.append('<span id="breadcrumbs-expand" class="tip-simple ui-icon-large ui-icon-triangle-1-e " tip="exapand"></span>').append(this.hiddenContainer).append(b),this.bc.children(":last").before(" &raquo; "),this.expand=e("#breadcrumbs-expand"),this.expand.click(function(){bc.exp?bc.show():bc.hide()}),this.width=this.hiddenContainer.width(),this.hide()},show:function(){bc.hiddenContainer.animate({width:bc.width},function(){bc.hiddenContainer.css("width","auto")}).css("visibility","visible"),bc.expand.attr("tip","minimize"),bc.expand.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-w"),bc.exp=!1},hide:function(){bc.hiddenContainer.animate({width:0},function(){bc.hiddenContainer.css("visibility","hidden")}),bc.expand.attr("tip","expand"),bc.expand.removeClass("ui-icon-triangle-1-w").addClass("ui-icon-triangle-1-e"),bc.exp=!0}},bd={google:{name:"Google",url:"https://www.google.com/accounts/o8/id"},facebook:{name:"Facebook",url:"http://facebook.anyopenid.com/"}},be=e.extend({},bd),bf={signin:function(a,b){var c=be[a];if(!c)return;var e="/auth/popup?id="+a+"&url="+c.url+"&redirect="+d;this.popupWin(e)},popupWin:function(b){var c=400,d=600,e=screen.width/2-d/2,f=screen.height/2-c/2,g=a.open(b,"popup","status=no,resizable=yes,height="+c+",width="+d+",left="+e+",top="+f+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no");g.focus()}};return{init:n,displayNotification:s,ajaxGet:v,hideTextOnFocus:x,goToAnchor:M,systemMessage:t,Breadcrumbs:bc,setLoading:u,SearchResult:B,resetLayout:W,openAllWidgets:S,deleteLayout:J,columns:I,setLayout:K,resetPageLayout:L,search:z,search_change:A,loadResults:C,openid:bf,validate_fields:Z,StaticWidgets:bb,recordOutboundLink:E,comment:_,issue:ba,getDataTables:bh,getMarkItUp:bk,getColorbox:bl,effects:r}}();e(b).ready(function(){e.ajaxSetup({timeout:6e4}),f.init()}),a.WB=f,a.$jq=e}(this,document)